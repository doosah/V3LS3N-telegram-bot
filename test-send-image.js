// Ð¢ÐµÑÑ‚Ð¾Ð²Ñ‹Ð¹ ÑÐºÑ€Ð¸Ð¿Ñ‚ Ð´Ð»Ñ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ ÑÐ²Ð¾Ð´Ð½Ð¾Ð¹ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹ Ð² Telegram
import dotenv from 'dotenv';
dotenv.config();

import { getCurrentDateISO, sendFinalReport } from './index.js';

async function testSendImage() {
    console.log('ðŸ§ª Ð¢ÐµÑÑ‚Ð¾Ð²Ð°Ñ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ° Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ ÑÐ²Ð¾Ð´Ð½Ð¾Ð¹ Ñ‚Ð°Ð±Ð»Ð¸Ñ†Ñ‹ Ð² Telegram...');
    
    try {
        // ÐŸÐ¾Ð»ÑƒÑ‡Ð°ÐµÐ¼ Ñ‚ÐµÐºÑƒÑ‰ÑƒÑŽ Ð´Ð°Ñ‚Ñƒ
        const dateISO = getCurrentDateISO();
        
        // ÐžÐ¿Ñ€ÐµÐ´ÐµÐ»ÑÐµÐ¼ ÑÐ¼ÐµÐ½Ñƒ Ð¿Ð¾ Ñ‚ÐµÐºÑƒÑ‰ÐµÐ¼Ñƒ Ð²Ñ€ÐµÐ¼ÐµÐ½Ð¸
        const now = new Date();
        const moscowTime = new Date(now.toLocaleString('en-US', { timeZone: 'Europe/Moscow' }));
        const hour = moscowTime.getHours();
        const shiftType = (hour >= 6 && hour < 18) ? 'day' : 'night';
        
        console.log(`ðŸ“… Ð”Ð°Ñ‚Ð°: ${dateISO}`);
        console.log(`ðŸŒ“ Ð¡Ð¼ÐµÐ½Ð°: ${shiftType === 'day' ? 'Ð”Ð½ÐµÐ²Ð½Ð°Ñ' : 'ÐÐ¾Ñ‡Ð½Ð°Ñ'}`);
        
        // ÐžÑ‚Ð¿Ñ€Ð°Ð²Ð»ÑÐµÐ¼ Ð¾Ñ‚Ñ‡ÐµÑ‚
        const result = await sendFinalReport(dateISO, shiftType);
        
        if (result) {
            console.log('âœ… Ð˜Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ðµ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾ Ð¾Ñ‚Ð¿Ñ€Ð°Ð²Ð»ÐµÐ½Ð¾ Ð² Telegram!');
            process.exit(0);
        } else {
            console.error('âŒ ÐžÑˆÐ¸Ð±ÐºÐ° Ð¾Ñ‚Ð¿Ñ€Ð°Ð²ÐºÐ¸ Ð¸Ð·Ð¾Ð±Ñ€Ð°Ð¶ÐµÐ½Ð¸Ñ');
            process.exit(1);
        }
    } catch (error) {
        console.error('âŒ ÐšÑ€Ð¸Ñ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ð¾ÑˆÐ¸Ð±ÐºÐ°:', error.message);
        console.error('Stack:', error.stack);
        process.exit(1);
    }
}

testSendImage();

